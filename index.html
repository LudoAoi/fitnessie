<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvolveFit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="onboarding-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="onboarding-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <div id="onboarding-header" class="mb-6 text-center">
                <h2 class="text-3xl font-extrabold mb-2">Welcome to EvolveFit!</h2>
                <p class="text-gray-500">Let's build your personalized fitness plan.</p>
            </div>
            
            <div class="progress-bar-container mb-8">
                <div class="progress-bar" id="onboarding-progress-bar" style="width: 11.1%;"></div>
            </div>

            <form id="onboarding-form">
                <div id="onboarding-step-1" class="onboarding-step active">
                    <div class="space-y-4 text-left">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="age" class="block text-sm font-medium text-gray-700 mb-1">Age</label>
                                <input type="number" id="age" name="age" class="modal-input w-full" required>
                            </div>
                            <div>
                                <label for="assigned_sex" class="block text-sm font-medium text-gray-700 mb-1">Assigned Sex at Birth</label>
                                <select id="assigned_sex" name="assigned_sex" class="modal-input w-full" required>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">This helps us calculate your initial metabolic baseline using standard formulas. It does not define your gender.</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="weight" class="block text-sm font-medium text-gray-700 mb-1">Weight (kg)</label>
                                <input type="number" id="weight" name="weight" step="0.1" class="modal-input w-full" required>
                            </div>
                            <div>
                                <label for="height" class="block text-sm font-medium text-gray-700 mb-1">Height (cm)</label>
                                <input type="number" id="height" name="height" class="modal-input w-full" required>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="fat_percent" class="block text-sm font-medium text-gray-700 mb-1">Body Fat % (Optional)</label>
                                <input type="number" id="fat_percent" name="fat_percent" step="0.1" class="modal-input w-full">
                            </div>
                            <div>
                                <label for="muscle_percent" class="block text-sm font-medium text-gray-700 mb-1">Muscle % (Optional)</label>
                                <input type="number" id="muscle_percent" name="muscle_percent" step="0.1" class="modal-input w-full">
                            </div>
                        </div>
                        <div>
                            <label for="gender_identity" class="block text-sm font-medium text-gray-700 mb-1">Gender Identity (Optional)</label>
                            <input type="text" id="gender_identity" name="gender_identity" class="modal-input w-full" placeholder="e.g., Woman, Man, Non-binary">
                        </div>
                    </div>
                    <div class="mt-4 text-center">
                        <button type="button" class="text-sm text-gray-500 hover:text-gray-800" data-action="fill-random">Fill Random Data & Start</button>
                    </div>
                </div>

                <div id="onboarding-step-2" class="onboarding-step">
                    <div class="space-y-6 text-left">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Primary Goal</label>
                            <div class="radio-group">
                                <div><input type="radio" id="goal-lose-fat" name="goal" value="lose_fat" checked><label for="goal-lose-fat">Lose Fat</label></div>
                                <div><input type="radio" id="goal-gain-muscle" name="goal" value="gain_muscle"><label for="goal-gain-muscle">Gain Muscle</label></div>
                                <div><input type="radio" id="goal-recomp" name="goal" value="recomp"><label for="goal-recomp">Body Recomp</label></div>
                                <div><input type="radio" id="goal-maintain" name="goal" value="maintain"><label for="goal-maintain">Maintenance</label></div>
                            </div>
                        </div>
                         <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Physique Goals (Optional)</label>
                            <div class="check-group">
                                <div><input type="checkbox" id="physique-shoulders" name="physiqueGoals" value="build_shoulder_width"><label for="physique-shoulders">Build Broader Shoulders</label></div>
                                <div><input type="checkbox" id="physique-hips" name="physiqueGoals" value="build_hip_width"><label for="physique-hips">Build Fuller Hips/Glutes</label></div>
                                <div><input type="checkbox" id="physique-chest" name="physiqueGoals" value="chest_emphasis"><label for="physique-chest">Build a Larger Chest</label></div>
                                <div><input type="checkbox" id="physique-arms" name="physiqueGoals" value="arm_emphasis"><label for="physique-arms">Build Bigger Arms</label></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="onboarding-step-3" class="onboarding-step">
                    <div class="space-y-6 text-left">
                        <label class="block text-sm font-medium text-gray-700 mb-2">To better tailor your plan, you can optionally sync your workouts with your hormonal cycle. How would you like to proceed?</label>
                        <div class="radio-group">
                            <div><input type="radio" id="cycle-track" name="hormoneProfile" value="track_cycle"><label for="cycle-track">Track my menstrual cycle</label></div>
                            <div><input type="radio" id="cycle-stable" name="hormoneProfile" value="stable_hormones"><label for="cycle-stable">I have a stable hormone profile (e.g., on HRT, menopause, etc.)</label></div>
                            <div><input type="radio" id="cycle-skip" name="hormoneProfile" value="skip" checked><label for="cycle-skip">Skip this step</label></div>
                        </div>
                    </div>
                </div>

                <div id="onboarding-step-4" class="onboarding-step">
                    <div class="space-y-6 text-left">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Primary Dietary Preference</label>
                            <div class="radio-group">
                                <div><input type="radio" id="diet-omnivore" name="diet_preference" value="omnivore" checked><label for="diet-omnivore">Omnivore</label></div>
                                <div><input type="radio" id="diet-flexitarian" name="diet_preference" value="flexitarian"><label for="diet-flexitarian">Flexitarian</label></div>
                                <div><input type="radio" id="diet-pescatarian" name="diet_preference" value="pescatarian"><label for="diet-pescatarian">Pescatarian</label></div>
                                <div><input type="radio" id="diet-vegetarian" name="diet_preference" value="vegetarian"><label for="diet-vegetarian">Vegetarian</label></div>
                                <div><input type="radio" id="diet-vegan" name="diet_preference" value="vegan"><label for="diet-vegan">Vegan</label></div>
                            </div>
                        </div>
                
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Follow a Specific Dietary Pattern? (Optional)</label>
                            <div class="check-group">
                                <div><input type="checkbox" id="pattern-mediterranean" name="dietary_pattern" value="mediterranean"><label for="pattern-mediterranean">Mediterranean</label></div>
                                <div><input type="checkbox" id="pattern-halal" name="dietary_pattern" value="halal"><label for="pattern-halal">Halal</label></div>
                                <div><input type="checkbox" id="pattern-kosher" name="dietary_pattern" value="kosher"><label for="pattern-kosher">Kosher</label></div>
                            </div>
                        </div>
                
                        <div>
                           <label class="block text-sm font-medium text-gray-700 mb-2">Any Allergies or Restrictions?</label>
                           <div class="check-group">
                               <div><input type="checkbox" id="allergy-gluten_free" name="restrictions" value="gluten_free"><label for="allergy-gluten_free">Gluten</label></div>
                               <div><input type="checkbox" id="allergy-dairy_free" name="restrictions" value="dairy_free"><label for="allergy-dairy_free">Dairy</label></div>
                               <div><input type="checkbox" id="allergy-nut_free" name="restrictions" value="nut_free"><label for="allergy-nut_free">Nuts</label></div>
                               <div><input type="checkbox" id="restriction-no_pork" name="restrictions" value="no_pork"><label for="restriction-no_pork">No Pork</label></div>
                               <div><input type="checkbox" id="restriction-no_shellfish" name="restrictions" value="no_shellfish"><label for="restriction-no_shellfish">No Shellfish</label></div>
                               <div><input type="checkbox" id="restriction-no_red_meat" name="restrictions" value="no_red_meat"><label for="restriction-no_red_meat">No Red Meat</label></div>
                           </div>
                       </div>
                    </div>
                </div>

                <div id="onboarding-step-5" class="onboarding-step">
                    <div class="space-y-6 text-left">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Where do you train?</label>
                            <div class="radio-group">
                                <div><input type="radio" id="env-home" name="training_environment" value="home" checked><label for="env-home">Home</label></div>
                                <div><input type="radio" id="env-gym" name="training_environment" value="gym"><label for="env-gym">Gym</label></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="onboarding-step-6" class="onboarding-step">
                    <div class="check-group">
                        <div><input type="checkbox" id="equip-bodyweight" name="equipment" value="bodyweight"><label for="equip-bodyweight">Bodyweight</label></div>
                        <div><input type="checkbox" id="equip-dumbbells_pair" name="equipment" value="dumbbells_pair"><label for="equip-dumbbells_pair">Dumbbells (Pair)</label></div>
                        <div><input type="checkbox" id="equip-dumbbells_single" name="equipment" value="dumbbells_single"><label for="equip-dumbbells_single">Dumbbell (Single)</label></div>
                        <div><input type="checkbox" id="equip-barbell" name="equipment" value="barbell"><label for="equip-barbell">Barbell</label></div>
                        <div><input type="checkbox" id="equip-pullup_bar" name="equipment" value="pullup_bar"><label for="equip-pullup_bar">Pull-up Bar</label></div>
                        <div><input type="checkbox" id="equip-bench" name="equipment" value="bench"><label for="equip-bench">Bench</label></div>
                        <div><input type="checkbox" id="equip-bands" name="equipment" value="bands"><label for="equip-bands">Bands</label></div>
                        <div><input type="checkbox" id="equip-yoga_blocks" name="equipment" value="yoga_blocks"><label for="equip-yoga_blocks">Yoga Blocks</label></div>
                        <div><input type="checkbox" id="equip-jump_rope" name="equipment" value="jump_rope"><label for="equip-jump_rope">Jump Rope</label></div>
                    </div>
                    <label class="block text-sm font-medium text-gray-700 mb-2 mt-6">Adaptive & Household Items</label>
                    <div class="check-group">
                        <div><input type="checkbox" id="equip-grip-aids" name="equipment" value="grip_aids"><label for="equip-grip-aids">Grip Aids</label></div>
                        <div><input type="checkbox" id="equip-wheelchair-straps" name="equipment" value="wheelchair_straps"><label for="equip-wheelchair-straps">Wheelchair Straps</label></div>
                        <div><input type="checkbox" id="equip-water-bottles" name="equipment" value="water_bottles"><label for="equip-water-bottles">Water Bottles / Cans</label></div>
                        <div><input type="checkbox" id="equip-towel" name="equipment" value="towel"><label for="equip-towel">Towel</label></div>
                    </div>
                    <p id="equipment-validation-msg" class="text-red-500 text-sm mt-2 h-4"></p>
                </div>
                <div id="onboarding-step-7" class="onboarding-step">
                    <div class="space-y-6 text-left">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">What's your training intensity?</label>
                            <div class="radio-group grid-cols-1">
                                <div><input type="radio" id="intensity-casual" name="trainingIntensity" value="casual" checked><label for="intensity-casual">"I'm too young to die." (Casual)</label></div>
                                <div><input type="radio" id="intensity-standard" name="trainingIntensity" value="standard"><label for="intensity-standard">"Hurt me plenty." (Standard)</label></div>
                                <div><input type="radio" id="intensity-intense" name="trainingIntensity" value="intense"><label for="intensity-intense">"Ultra-Violence." (Intense)</label></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="onboarding-step-8" class="onboarding-step">
                    <div class="space-y-6 text-left">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">How do you primarily move?</label>
                            <div class="radio-group">
                                <div><input type="radio" id="mobility-standing" name="mobility" value="standing" checked><label for="mobility-standing">Standing & Walking</label></div>
                                <div><input type="radio" id="mobility-seated" name="mobility" value="seated"><label for="mobility-seated">Seated / Wheelchair User</label></div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Please select any that apply to you:</label>
                            <div class="check-group">
                                <div><input type="checkbox" id="limb-no_legs" name="limitations" value="no_leg_use"><label for="limb-no_legs">No use of legs</label></div>
                                <div><input type="checkbox" id="limb-limited_left_arm" name="limitations" value="limited_left_arm"><label for="limb-limited_left_arm">Limited use of left arm/hand</label></div>
                                <div><input type="checkbox" id="limb-limited_right_arm" name="limitations" value="limited_right_arm"><label for="limb-limited_right_arm">Limited use of right arm/hand</label></div>
                                <div><input type="checkbox" id="limb-no_arms" name="limitations" value="no_arm_use"><label for="limb-no_arms">No use of arms/hands</label></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="onboarding-step-9" class="onboarding-step">
                    <div class="space-y-6 text-left">
                        <div>
                            <label for="training_days" class="block text-sm font-medium text-gray-700 mb-2">How many days per week can you train?</label>
                            <select id="training_days" name="training_days" class="modal-input w-full"><option value="3">3 Days</option><option value="4">4 Days</option><option value="5">5 Days</option></select>
                        </div>
                        <div>
                            <p class="block text-sm font-medium text-gray-700 mb-2">To the best of your ability, how many reps can you do?</p>
                            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                                <div><label for="max_squats" class="block text-xs font-medium text-gray-500 mb-1">Bodyweight Squats</label><input type="number" id="max_squats" name="max_squats" class="modal-input w-full" placeholder="e.g., 25" required></div>
                                <div><label for="max_pushups" class="block text-xs font-medium text-gray-700 mb-1">Push-ups</label><input type="number" id="max_pushups" name="max_pushups" class="modal-input w-full" placeholder="e.g., 10" required></div>
                                <div><label for="max_pullups" class="block text-xs font-medium text-gray-500 mb-1">Pull-ups</label><input type="number" id="max_pullups" name="max_pullups" class="modal-input w-full" placeholder="e.g., 1" required></div>
                            </div>
                              <p id="onboarding-validation-msg" class="text-red-500 text-sm mt-2 h-4"></p>
                        </div>
                    </div>
                </div>
                <div id="onboarding-step-10" class="onboarding-step">
                      <div>
                        <label for="start_day" class="block text-sm font-medium text-gray-700 mb-2">Choose your first training day</label>
                        <select id="start_day" name="start_day" class="modal-input w-full"></select>
                    </div>
                </div>
                <div class="mt-8 flex gap-4">
                    <button type="button" id="onboarding-back-btn" class="secondary-btn" data-action="onboarding-back">Back</button>
                    <button type="button" id="onboarding-next-btn" class="primary-btn" data-action="onboarding-next">Next</button>
                    <button type="submit" id="onboarding-finish-btn" class="primary-btn" data-action="onboarding-finish" style="display: none;">Generate My Plan</button>
                </div>
            </form>
        </div>
    </div>
    
    <header class="app-header fixed top-0 left-0 right-0">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between h-20">
                <div class="text-2xl font-extrabold tracking-tighter text-gray-800">EvolveFit</div>
                <div class="flex-1 flex justify-center items-center overflow-x-auto">
                    <nav class="flex space-x-1 md:space-x-2">
                        <button class="nav-btn px-3 py-2" data-action="open-tab" data-tab-id="monday">Mon</button>
                        <button class="nav-btn px-3 py-2" data-action="open-tab" data-tab-id="tuesday">Tue</button>
                        <button class="nav-btn px-3 py-2" data-action="open-tab" data-tab-id="wednesday">Wed</button>
                        <button class="nav-btn px-3 py-2" data-action="open-tab" data-tab-id="thursday">Thu</button>
                        <button class="nav-btn px-3 py-2" data-action="open-tab" data-tab-id="friday">Fri</button>
                        <button class="nav-btn px-3 py-2" data-action="open-tab" data-tab-id="saturday">Sat</button>
                        <button class="nav-btn px-3 py-2" data-action="open-tab" data-tab-id="sunday">Sun</button>
                        <button class="nav-btn px-3 py-2 text-gray-800 font-semibold" data-action="open-tab" data-tab-id="progress">Progress</button>
                        <button class="nav-btn px-3 py-2 text-gray-800 font-semibold" data-action="open-tab" data-tab-id="check-in">Check-in</button>
                    </nav>
                </div>
            </div>
        </div>
    </header>

    <div class="main-app-container">
        <div class="container mx-auto p-4 md:p-6 lg:max-w-6xl">
            <header class="text-center my-8 md:my-12">
                <h1 id="main-title" class="text-3xl lg:text-4xl">Your Adaptive Plan</h1>
                <p class="text-lg mt-2" id="week-counter">Loading...</p>
            </header>
            <main id="main-content-grid" class="grid grid-cols-1 lg:grid-cols-3 lg:gap-8">
                <div class="lg:col-span-2 space-y-8" id="workout-column"></div>
                <div class="hidden lg:block space-y-8" id="nutrition-column"></div>
            </main>
        </div>
    </div>
    
    <div id="recipe-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
             <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="recipe-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <div id="recipe-modal-content"></div>
        </div>
    </div>
    <div id="history-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="history-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
              <h2 class="text-2xl font-bold mb-4" id="history-modal-title">Workout History</h2>
              <div id="history-modal-dynamic-content" class="space-y-4"></div>
              <button class="mt-6 secondary-btn" data-action="close-modal" data-modal-id="history-modal">Close</button>
        </div>
    </div>
    <div id="swap-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
              <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="swap-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <div id="swap-modal-content"></div>
        </div>
    </div>
    <div id="summary-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="summary-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h2 class="text-2xl font-bold mb-4">Day Complete!</h2>
            <div id="summary-modal-content" class="text-left space-y-4 mb-6"></div>
            <button class="mt-8 primary-btn w-full" data-action="submit-day-feedback">Log Workout</button>
        </div>
    </div>
    <div id="progression-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
              <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="progression-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h2 class="text-2xl font-bold mb-4" id="progression-title">Plan Updated!</h2>
            <div class="text-gray-500 mb-6 text-left" id="progression-suggestion"></div>
            <button class="primary-btn" data-action="close-modal" data-modal-id="progression-modal">Awesome!</button>
        </div>
    </div>
    <div id="edit-profile-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="edit-profile-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h2 class="text-2xl font-bold mb-4">Edit Profile</h2>
            <form id="edit-profile-form" class="space-y-4 text-left">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Training Intensity</label>
                    <div class="radio-group grid-cols-1" id="edit-intensity-group"></div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Your Diet</label>
                    <div class="radio-group" id="edit-diet-group"></div>
                </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Your Equipment</label>
                    <div class="check-group" id="edit-equipment-group"></div>
                </div>
                <div class="flex gap-4 pt-4">
                    <button type="button" class="secondary-btn" data-action="close-modal" data-modal-id="edit-profile-modal">Cancel</button>
                    <button type="submit" class="primary-btn">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
    <div id="change-schedule-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
              <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="change-schedule-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h2 class="text-2xl font-bold mb-4">Adjust Weekly Schedule</h2>
            <p class="text-gray-500 mb-6">Select your desired workout days for the current week.</p>
            <form id="change-schedule-form" class="space-y-3 text-left">
            </form>
            <div class="flex gap-4 pt-6">
                <button type="button" class="secondary-btn" data-action="close-modal" data-modal-id="change-schedule-modal">Cancel</button>
                <button type="submit" form="change-schedule-form" class="primary-btn">Update Schedule</button>
            </div>
        </div>
    </div>
    <div id="weekly-checkin-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
              <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="weekly-checkin-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <div class="text-center mb-6">
                <h2 class="text-3xl font-extrabold mb-2">Weekly Check-in</h2>
                <p class="text-gray-500" id="weekly-checkin-subtitle">Let's fine-tune your plan for Week ...</p>
            </div>
            <form id="checkin-form" class="space-y-6">
                <div>
                    <label for="weekly-rpe" class="block text-lg font-medium text-gray-700 mb-3 text-center">Training Difficulty (1=Easy, 10=Max)</label>
                    <input type="range" id="weekly-rpe" name="rpe" min="1" max="10" value="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-xs text-gray-500 px-1 mt-1">
                        <span>Easy</span><span id="weekly-rpe-value">5</span><span>Max</span>
                    </div>
                </div>
                <div>
                    <label for="hunger-level" class="block text-lg font-medium text-gray-700 mb-3 text-center">Hunger Levels (1=Starving, 5=Stuffed)</label>
                    <input type="range" id="hunger-level" name="hunger_level" min="1" max="5" value="3" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-xs text-gray-500 px-1 mt-1">
                        <span>Starving</span><span id="hunger-level-value">3</span><span>Stuffed</span>
                    </div>
                </div>
                <div>
                    <label for="adherence-rating" class="block text-lg font-medium text-gray-700 mb-3 text-center">Diet Adherence (1=Hard, 5=Easy)</label>
                    <input type="range" id="adherence-rating" name="adherence_rating" min="1" max="5" value="3" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-xs text-gray-500 px-1 mt-1">
                        <span>Hard</span><span id="adherence-rating-value">3</span><span>Easy</span>
                    </div>
                </div>
                <div>
                    <label for="checkin-focus" class="block text-lg font-medium text-gray-700 mb-3 text-center">Workout Focus</label>
                    <select id="checkin-focus" name="focus" class="modal-input w-full"></select>
                </div>
                <div>
                    <label class="block text-lg font-medium text-gray-700 mb-3 text-center">Update your stats</label>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div><label for="checkin-weight" class="block text-xs font-medium text-gray-500 mb-1">Weight (kg)</label><input type="number" id="checkin-weight" name="weight" step="0.1" class="modal-input w-full" required></div>
                        <div><label for="checkin-fat" class="block text-xs font-medium text-gray-500 mb-1">Body Fat %</label><input type="number" id="checkin-fat" name="fat_percent" step="0.1" class="modal-input w-full"></div>
                        <div><label for="checkin-muscle" class="block text-xs font-medium text-gray-500 mb-1">Muscle %</label><input type="number" id="checkin-muscle" name="muscle_percent" step="0.1" class="modal-input w-full"></div>
                    </div>
                </div>
                <div>
                    <label class="block text-lg font-medium text-gray-700 mb-3 text-center">Update measurements (cm)</label>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div><label for="checkin-waist" class="block text-xs font-medium text-gray-500 mb-1">Waist</label><input type="number" id="checkin-waist" name="waist" step="0.1" class="modal-input w-full"></div>
                        <div><label for="checkin-hips" class="block text-xs font-medium text-gray-500 mb-1">Hips</label><input type="number" id="checkin-hips" name="hips" step="0.1" class="modal-input w-full"></div>
                        <div><label for="checkin-chest" class="block text-xs font-medium text-gray-700 mb-1">Chest</label><input type="number" id="checkin-chest" name="chest" step="0.1" class="modal-input w-full"></div>
                    </div>
                </div>
                <div class="mt-8 flex justify-end">
                    <button type="submit" class="primary-btn">Start Next Week!</button>
                </div>
            </form>
        </div>
    </div>

    <div id="timer-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8 text-center">
            <h2 id="timer-title" class="text-3xl font-bold mb-2">HIIT Timer</h2>
            <p id="timer-exercise-name" class="text-lg text-gray-400 mb-6">High Knees</p>
            <div id="timer-display" class="text-8xl font-bold my-8">10</div>
            <div id="timer-status" class="text-2xl font-semibold uppercase tracking-widest mb-4">Get Ready</div>
            <div id="timer-round" class="text-gray-400">Round 1 / 10</div>
            <button class="mt-8 secondary-btn" data-action="stop-timer">Stop Timer</button>
        </div>
    </div>
    <div id="export-modal" class="modal-overlay">
        <div class="modal-content p-6 md:p-8">
            <button class="absolute top-4 right-4 text-gray-400 hover:text-gray-600" data-action="close-modal" data-modal-id="export-modal">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h2 class="text-2xl font-bold mb-4">Export Shopping List</h2>
            <p class="text-gray-500 mb-6">How many people are you cooking for? This will scale the ingredient quantities accordingly.</p>
            <form id="export-form">
                <div>
                    <label for="people-count" class="block text-sm font-medium text-gray-700 mb-1">Number of People</label>
                    <input type="number" id="people-count" name="people_count" class="modal-input w-full" value="1" min="1" required>
                </div>
                <div class="flex justify-end gap-4 pt-6">
                    <button type="button" class="secondary-btn" data-action="close-modal" data-modal-id="export-modal">Cancel</button>
                    <button type="submit" class="primary-btn">Export CSV</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>
